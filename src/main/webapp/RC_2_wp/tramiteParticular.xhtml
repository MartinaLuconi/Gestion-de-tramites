<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui" xmlns:adm="http://github.com/adminfaces"
                template="#{layoutMB.template}">

    <ui:define name="metadata">
        <f:metadata>

        </f:metadata>
        <ui:param name="renderFormAsterisks" value="true"/>
    </ui:define>
    <ui:define name="title">
        Datos del tramite número #{uiTramiteParticular.nroTramite}  
    </ui:define>
    <ui:define name="description">
         - asignado a #{uiTramitesConsultor.nombreConsultor} - Legajo: #{uiTramitesConsultor.legajoConsultor}
  
    </ui:define>
    <ui:define name="body">
        

        
        <div class="card">
            <h:form id="form">
               
                <div class="card flex justify-content-center">
                    <!-- mostrar datos del tramite -->
                <p:dataViewGridItem id="tramiteDet"> 
                    <h:panelGrid   columns="2" style="margin: 30px" cellpadding="10">
                                <h:outputText value="Nro Tramite:" styleClass="font-weight: bold; "/>
                                <h:outputText value="#{uiTramiteParticular.nroTramite}"/>
                                
                                <h:outputText value="Cliente:" styleClass="text-secondary"/>
                                <h:outputText value="#{uiTramiteParticular.nombreApellidoCliente}"/>
                                
                                <h:outputText value="Cuit: " styleClass="text-secondary"/>
                                <h:outputText value="#{uiTramiteParticular.cuitCliente}"/>
                                   
                                <h:outputText value="Precio:" styleClass="text-secondary" />
                                <h:outputText value="$#{uiTramiteParticular.precioTipoTramite}"/>


                                <h:outputText value="Codigo Tipo Tramite:" styleClass="text-secondary"/>
                                <h:outputText value="#{uiTramiteParticular.codTipoTramite}"/>

                                <h:outputText value="Fecha Documentacion" styleClass="text-secondary"/>
                                <h:outputText value="#{uiTramiteParticular.fechaHoraFinEntregaDoc}"/>
                            
                                   
                               <h:outputText value="Fecha inicio: " styleClass="text-secondary" />
                               <h:outputText value="#{uiTramiteParticular.fechaHoraCargaTramite}"/>
                               
                               <h:outputText value="Fecha Fin Tramite: " styleClass="text-secondary" />
                               <h:outputText value="#{uiTramiteParticular.fechaHoraFinTramite}"/>
                               
                               
                                <h:outputText value="Estado actual: " styleClass="text-secondary"/>
                                <h:outputText value="#{uiTramiteParticular.nombreEstadoTramite}"/>
                                
                                <h:outputText value="Tipo Tramite: " styleClass="text-secondary"/>
                                <h:outputText value="#{uiTramiteParticular.nombreTipoTramite}"/>
                                <h:outputText value="Observacion: " styleClass="text-secondary"/> 
                                <p:card style="width: 75rem; margin-bottom: 2em">
                                    <p>#{uiTramiteParticular.observacionTramiteEstado}</p>
                                     
                                </p:card>
                                
                        </h:panelGrid>
                </p:dataViewGridItem>
                </div>
               
                <div>
                    <p:dataTable id="grid1" widgetVar="TramiteParticularTable"  value="#{uiTramiteParticular.etapas(nroTramite)}" 
                                 var="tramiteEstado"
                                 style="text-align: center;">

                    <p:column sortBy="#{tramiteEstado.nroLineaTramiteEstado}">
                        <f:facet name="header">Nro Linea</f:facet>
                        #{tramiteEstado.nroLineaTramiteEstado}

                    </p:column>

                    <p:column>
                        <f:facet name="header">Codigo</f:facet>
                        #{tramiteEstado.codEstadoTramite}
                    </p:column>

                    <p:column>
                        <f:facet name="header">Estado</f:facet>
                        #{tramiteEstado.nombreEstadoTramite}

                    </p:column>

                    <p:column>
                        <f:facet name="header">Observaciones</f:facet>
                        #{tramiteEstado.observacionTramiteEstado}
                    </p:column>

                    <p:column>
                        <f:facet name="header">Fecha Baja</f:facet>
                        #{tramiteEstado.fechaBajaTramiteEstado}

                    </p:column>
                    
                    <p:column>
                        <f:facet name="header">Fecha Cambio</f:facet>
                        #{tramiteEstado.fechaCambio}

                    </p:column>
                        
                    <p:column>
                        <p:commandButton  styleClass="btn-material btn-primary"
                                          icon="pi pi-undo"  actionListener="#{uiTramiteParticular.anularUltimo(uiTramiteParticular.nroTramite)}"
                                          disabled="#{tramiteEstado.fechaBajaTramiteEstado!=null}"
                                          update="@form:grid1">
                            <p:confirm header="Anulación de #{uiTramiteParticular.nombreEstadoTramite}" message="¿Está seguro?" icon="ui-icon-alert"/>
                            <f:ajax render="@form"/>
                        </p:commandButton>
                        
                        <p:confirmDialog global="true"  showEffect="fade" hideEffect="fade" styleClass="box-solid box-danger">
                        <p:commandButton value="Confirmar" type="button" styleClass="btn-material btn-primary ui-confirmdialog-yes"
                                         icon="fa fa-check" update="@form:grid1" />
                        <p:commandButton value="Cancelar" type="button" styleClass="btn-material btn-danger ui-confirmdialog-no"
                                         icon="fa fa-close" update="@form:grid1 @form:tramiteDet"/>
                    </p:confirmDialog>
                    </p:column> 
                   
                     <p:ajax event="rowEdit" update="@form:grid1 @form:tramiteDet" />
                </p:dataTable>
                </div>
       
                
            <div class="box-header with-border" >
                <div id="main-buttons" style="text-align: right;">
                    <p:commandButton value="Nuevo Estado" icon="fa fa-plus"  styleClass="rounded-button btn-primary"
                                     disabled="#{uiTramiteParticular.fechaHoraFinTramite != null}"
                                     action="#{uiTramiteParticular.irNuevoEstado()}"/>

                 </div>
            </div>
               <!-- PARA CASO DE PRUEBA -->
            <div class="box-header with-border" >
                <div id="main-buttons" style="text-align: right;">
                    <p:commandButton value="Prueba"  styleClass="rounded-button btn-primary"
                                     action="#{uiTramiteParticular.irPrueba()}"
                                     disabled="#{uiTramiteParticular.nroTramite != 6}"/>

                 </div>
            </div>
                
                 
    </h:form>
    </div>
   
   

    </ui:define>

    </ui:composition >


